app-id: net.baseart.Glide
runtime: org.gnome.Platform
runtime-version: '41'
sdk: org.gnome.Sdk
sdk-extensions:
- org.freedesktop.Sdk.Extension.rust-stable
cleanup:
- /include
command: glide
finish-args:
- --device=dri
- --filesystem=xdg-download
- --filesystem=xdg-videos
- --metadata=X-DConf=migrate-path=/net/baseart/Glide/
- --share=ipc
- --share=network
- --socket=pulseaudio
- --socket=wayland
- --socket=x11
- --env=GST_VAAPI_ALL_DRIVERS=1
- --env=LIBVA_DRIVER_NAME=iHD
build-options:
  append-path: /usr/lib/sdk/rust-stable/bin
  env:
    CARGO_HOME: /run/build/glide/cargo
modules:
- name: ffmpeg
  builddir: true
  sources:
    - type: git
      url: https://git.ffmpeg.org/ffmpeg.git
      tag: n4.3.1
      commit: 6b6b9e593dd4d3aaf75f48d40a13ef03bdef9fdb
  config-opts:
    - --prefix="/app/"
    - --libdir="/app/lib"
    - --disable-doc
    - --disable-static
    - --enable-optimizations
    - --enable-shared
    - --disable-everything
    - --disable-ffplay
    - --disable-ffprobe
    - --enable-gnutls
    - --enable-libaom
    - --enable-libdav1d
    - --enable-libfdk-aac
    - --enable-libmp3lame
    - --enable-libfontconfig
    - --enable-libfreetype
    - --enable-libopenh264
    - --enable-libopus
    - --enable-libpulse
    - --enable-libspeex
    - --enable-libtheora
    - --enable-libvorbis
    - --enable-libvpx
    - --enable-libwebp
    - --enable-openal
    - --enable-opengl
    - --enable-sdl2
    - --enable-decoder=ac3,eac3,alac,flac,g723_1,g729,libfdk_aac,libopus,mp2,mp3,m4a,pcm_alaw,pcm_mulaw,pcm_f32le,pcm_s16be,pcm_s24be,pcm_s16le,pcm_s24le,pcm_s32le,pcm_u8,tta,vorbis,wavpack
    - --enable-decoder=ass,ffv1,libaom_av1,libdav1d,libopenh264,libvpx_vp8,libvpx_vp9,rawvideo,theora,vp8,vp9,flv,hevc,h263,h264,mpeg2video,mpeg4,msmpeg4,msmpeg4v1,msmpeg4v2,msmpeg4v3,vp6,vp6a,vp6f
    - --enable-decoder=gif,png,tiff,webp
    - --enable-parser=aac,ac3,flac,mpegaudio,mpeg4video,opus,vp3,vp8,vorbis,hevc,h264
    - --enable-demuxer=aac,ac3,ass,flac,gif,matroska,mov,mp3,mpegvideo,ogg,wav
    - --enable-filter=crop,scale
    - --enable-protocol=file 

- name: gst-libav
  builddir: true
  buildsystem: meson
  sources:
  - type: archive
    url: https://gstreamer.freedesktop.org/src/gst-libav/gst-libav-1.18.5.tar.xz
    sha256: 822e008a910e9dd13aedbdd8dc63fedef4040c0ee2e927bab3112e9de693a548
  config-opts:
  - -Ddoc=disabled

- name: glide
  buildsystem: meson
  sources:
  - type: archive
    url: https://github.com/philn/glide/releases/download/0.5.9/glide-0.5.9.tar.xz
    sha256: e426e8b085a89e7dc384fc241bf161732735f083ddc4099342859c289951c6a3
